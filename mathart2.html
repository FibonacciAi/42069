<!DOCTYPE html>
<html>
<head>
    <title>Mathematical Art Pattern</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* Previous styles remain the same */
    </style>
</head>
<body>
    <div id="canvas-container"></div>
    <div class="controls">
        <div class="slider-container">
            <label>Speed</label>
            <input type="range" id="speedSlider" min="1" max="100" value="100">
            <span class="value-display" id="speedValue">100</span>
        </div>
        <div class="slider-container">
            <label>Density</label>
            <input type="range" id="densitySlider" min="1000" max="40000" value="40000">
            <span class="value-display" id="densityValue">40000</span>
        </div>
        <div class="slider-container">
            <label>Wave Scale</label>
            <input type="range" id="waveSlider" min="1" max="20" value="18">
            <span class="value-display" id="waveValue">18</span>
        </div>
        <div class="slider-container">
            <label>Pattern Color</label>
            <input type="color" id="colorPicker" value="#00FF00" class="color-picker">
        </div>
    </div>

    <script>
        let t = 0;
        let speedMultiplier = 2;
        let density = 40000;
        let waveScale = 18;
        let patternColor;

        function setup() {
            const canvas = createCanvas(windowWidth, windowHeight);
            canvas.parent('canvas-container');
            patternColor = color(0, 255, 0);
            
            setupControlListeners();
        }

        function setupControlListeners() {
            // Previous control listeners remain the same
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }

        function a(x, y) {
            let d = waveScale * cos(
                mag(x/8 - 12.5, y/8 - 12.5) / 12 * 
                cos(sin(x/16) * cos(y/16))
            );
            
            let px = x + d * (x/8 - 12.5) * (
                sin(d * 2 + t) + 
                sin(y * mag(x/8 - 12.5, y/8 - 12.5) / 144) / 9
            );
            
            let py = y/3 - d * 40 + 19 * cos(d + t);
            
            point(px + width/2, py + height/2);
        }

        function draw() {
            background(0, 96);
            stroke(patternColor);
            strokeWeight(2);
            
            t += (PI / 90) * speedMultiplier;
            
            for (let i = 0; i < density; i++) {
                a(
                    (i % 200) - 100,
                    (i / 200) - 100
                );
            }
        }
    </script>
</body>
</html>
